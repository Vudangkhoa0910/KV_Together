# Chính sách xử lý chiến dịch hết hạn và hệ thống ví thiện nguyện KV Credits

## Tổng quan

Khi một chiến dịch gây quỹ hết hạn mà chưa đạt được mục tiêu tài chính, việc hoàn trả tiền trực tiếp cho các nhà tài trợ gặp nhiều khó khăn về mặt kỹ thuật và pháp lý. Để giải quyết vấn đề này, KV Together triển khai hệ thống **Ví thiện nguyện KV Credits** nhằm:

1. Bảo vệ quyền lợi của người quyên góp
2. Khuyến khích tiếp tục tham gia các chiến dịch thiện nguyện khác
3. Giảm thiểu chi phí và độ phức tạp trong việc hoàn trả
4. Tạo sự liên kết lâu dài với cộng đồng thiện nguyện
5. **Đảm bảo Credits chỉ được sử dụng cho mục đích từ thiện, không mang tính thương mại**

## Cơ chế hoạt động của Ví thiện nguyện KV Credits

### 1. Quy trình khi chiến dịch thành công
- Tiền quyên góp được chuyển trực tiếp cho tổ chức/cá nhân thụ hưởng
- Người quyên góp nhận thông báo về việc sử dụng tiền
- Ví ảo không bị ảnh hưởng

### 2. Quy trình khi chiến dịch thất bại (hết hạn chưa đủ mục tiêu)

#### 2.1 Tự động chuyển đổi sang KV Credits
- Sau 7 ngày từ khi chiến dịch hết hạn, số tiền quyên góp tự động được chuyển thành KV Credits
- Tỷ lệ chuyển đổi: 1 VND = 1 KV Credit
- Người dùng nhận thông báo qua email và app về việc chuyển đổi

#### 2.2 Lựa chọn cho người quyên góp
Trong vòng 7 ngày "grace period", người quyên góp có thể:
- **Chấp nhận chuyển thành KV Credits** (mặc định)
- **Yêu cầu hoàn tiền** (cần cung cấp thông tin ngân hàng, phí xử lý 5%)
- **Chuyển hỗ trợ sang chiến dịch khác** đang hoạt động

### 3. Sử dụng KV Credits thiện nguyện

#### 3.1 Nguyên tắc cốt lõi
- **KV Credits chỉ dành cho mục đích thiện nguyện**: Không thể chuyển đổi thành tiền mặt hoặc sử dụng cho mục đích thương mại
- **Không có giá trị kinh doanh**: Credits không tạo ra lợi nhuận, không được tính lãi, không phải công cụ đầu tư
- **Minh bạch và phi lợi nhuận**: Mọi hoạt động liên quan đến Credits đều phục vụ mục đích từ thiện

#### 3.2 Ưu điểm của KV Credits thiện nguyện
- Không mất phí giao dịch khi ủng hộ các chiến dịch từ thiện
- Có thể tích lũy để ủng hộ các chiến dịch lớn
- Nhận thông báo ưu tiên về các chiến dịch thiện nguyện mới
- Badge đặc biệt "Nhà hảo tâm KV" trên profile

#### 3.3 Cách sử dụng (chỉ cho mục đích thiện nguyện)
- **Ủng hộ trực tiếp các chiến dịch thiện nguyện** đang hoạt động
- **Kết hợp với tiền mặt** (ví dụ: 50% KV Credits + 50% tiền mặt) để ủng hộ
- **Tặng KV Credits cho người khác** để họ có thể tham gia thiện nguyện
- **Sử dụng trong các chương trình từ thiện đặc biệt** (matching funds, challenge campaigns)

#### 3.4 Hạn chế quan trọng
- **KHÔNG thể rút ra tiền mặt** dưới bất kỳ hình thức nào
- **KHÔNG thể mua bán hoặc trao đổi** với bên thứ ba
- **KHÔNG được sử dụng** cho mục đích thương mại, mua sắm cá nhân
- **CHỈ dành cho các hoạt động thiện nguyện** được xác minh trên nền tảng

## Chính sách chi tiết

### Thời hạn và điều kiện

| Trường hợp | Thời gian xử lý | Hành động |
|------------|-----------------|-----------|
| Chiến dịch thành công | Ngay lập tức | Chuyển tiền cho thụ hưởng |
| Hết hạn chưa đủ 30% mục tiêu | 3 ngày | Tự động hoàn tiền (nếu có thông tin NH) hoặc chuyển KV Credits |
| Hết hạn đạt 30-70% mục tiêu | 7 ngày | Cho phép lựa chọn: Credits, hoàn tiền, hoặc chuyển chiến dịch |
| Hết hạn đạt 70-99% mục tiêu | 14 ngày | Ưu tiên gia hạn chiến dịch, nếu không thì áp dụng như trên |

### Quyền lợi người dùng

#### KV Credits Tiers
- **Bronze** (< 1M Credits): Sử dụng cơ bản
- **Silver** (1M - 5M Credits): Ưu tiên thông báo, giảm 2% phí giao dịch
- **Gold** (5M - 20M Credits): Tham gia beta testing, giảm 5% phí giao dịch
- **Platinum** (> 20M Credits): Tư vấn 1-1, miễn phí giao dịch, ưu tiên hỗ trợ

#### Chương trình khuyến khích
- **Referral Bonus**: +5% Credits khi giới thiệu người mới
- **Loyalty Bonus**: +2% Credits mỗi tháng cho người dùng active
- **Impact Multiplier**: x1.5 Credits khi ủng hộ các chiến dịch có tác động cao

### Bảo mật và minh bạch

#### Quản lý tài chính
- Số dư KV Credits được backup bởi tài khoản ký quỹ riêng biệt
- Kiểm toán hàng quý bởi đơn vị độc lập
- Báo cáo minh bạch về tình hình tài chính Credits Pool

#### Bảo vệ người dùng
- KV Credits không có thời hạn sử dụng
- Không thể mất Credits do lỗi hệ thống
- Chính sách bảo hiểm cho Credits Pool
- Quyền chuyển đổi thành tiền mặt trong trường hợp đặc biệt

## Kịch bản thực tế

### Kịch bản 1: Chiến dịch xây trường học hết hạn
- **Mục tiêu**: 500M VND
- **Đạt được**: 350M VND (70%)
- **Số người quyên góp**: 1,200 người
- **Xử lý**: 
  - Gia hạn 30 ngày để tìm thêm 150M
  - Nếu không đủ: Chuyển 350M thành Credits cho 1,200 người
  - Gợi ý các chiến dịch giáo dục tương tự để họ tiếp tục ủng hộ

### Kịch bản 2: Chiến dịch cứu trợ khẩn cấp hết hạn
- **Mục tiêu**: 100M VND  
- **Đạt được**: 25M VND (25%)
- **Tình huống**: Đã qua thời điểm cần cứu trợ
- **Xử lý**:
  - Chuyển 25M thành Credits trong 3 ngày
  - Gợi ý chuyển sang quỹ cứu trợ dài hạn hoặc chiến dịch phục hồi

### Kịch bản 3: Người dùng tích lũy Credits
- **Người dùng A**: Có 2M Credits từ 3 chiến dịch thất bại
- **Hành động**: Sử dụng 2M Credits + 1M tiền mặt để ủng hộ chiến dịch 3M
- **Lợi ích**: Không mất phí giao dịch, được badge "Loyal Supporter"

## Triển khai kỹ thuật

### Database Schema

```sql
-- Bảng ví ảo
CREATE TABLE virtual_wallets (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id BIGINT NOT NULL,
    balance DECIMAL(15,2) DEFAULT 0,
    total_earned DECIMAL(15,2) DEFAULT 0,
    total_spent DECIMAL(15,2) DEFAULT 0,
    tier VARCHAR(10) DEFAULT 'bronze',
    created_at TIMESTAMP,
    updated_at TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id)
);

-- Lịch sử giao dịch Credits
CREATE TABLE credit_transactions (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    wallet_id BIGINT NOT NULL,
    type ENUM('earn', 'spend', 'transfer', 'bonus'),
    amount DECIMAL(15,2) NOT NULL,
    source_type VARCHAR(50), -- 'failed_campaign', 'donation', 'bonus', 'transfer'
    source_id BIGINT, -- ID của campaign, donation, etc.
    description TEXT,
    created_at TIMESTAMP,
    FOREIGN KEY (wallet_id) REFERENCES virtual_wallets(id)
);

-- Campaigns với trạng thái mở rộng
ALTER TABLE campaigns ADD COLUMN 
    expiry_action ENUM('refund', 'credits', 'extend') DEFAULT 'credits',
    grace_period_days INT DEFAULT 7;
```

### API Endpoints

```typescript
// Ví ảo
GET /api/wallet/balance - Xem số dư Credits
GET /api/wallet/transactions - Lịch sử giao dịch
POST /api/wallet/transfer - Chuyển Credits cho người khác
POST /api/wallet/redeem - Sử dụng Credits để ủng hộ

// Xử lý chiến dịch hết hạn  
POST /api/campaigns/{id}/process-expiry - Xử lý khi hết hạn
GET /api/campaigns/expired - Danh sách chiến dịch hết hạn chờ xử lý
POST /api/donations/{id}/convert-to-credits - Chuyển donation thành Credits
```

## Lộ trình triển khai

### Phase 1 (Tháng 1-2): Cơ sở hạ tầng
- Tạo database schema cho ví ảo
- API cơ bản cho Credits
- Dashboard quản lý Credits cho admin
- Cron job xử lý chiến dịch hết hạn

### Phase 2 (Tháng 3-4): Trải nghiệm người dùng
- Giao diện ví ảo trong app
- Tích hợp Credits vào quy trình donate
- Email/notification cho các sự kiện Credits
- Trang thống kê cá nhân về Credits

### Phase 3 (Tháng 5-6): Tính năng nâng cao
- Tier system và rewards
- Chương trình referral với Credits
- Tích hợp với payment gateway
- Mobile app optimization

### Phase 4 (Tháng 7+): Mở rộng
- API cho đối tác tích hợp Credits
- Marketplace sử dụng Credits
- Cross-platform rewards program
- Analytics và AI recommendations

## Rủi ro và giải pháp

### Rủi ro tài chính
- **Vấn đề**: Credits Pool không đủ khi nhiều người đồng thời đòi hoàn tiền
- **Giải pháp**: Tài khoản ký quỹ riêng + bảo hiểm + giới hạn hoàn tiền hàng tháng

### Rủi ro pháp lý
- **Vấn đề**: Credits có thể bị coi là "tiền ảo" cần giấy phép
- **Giải pháp**: Tư vấn pháp lý, định nghĩa rõ là "loyalty points", không thể đổi ra tiền

### Rủi ro kỹ thuật
- **Vấn đề**: Lỗi hệ thống làm mất Credits
- **Giải pháp**: Backup daily, audit trail, khôi phục tự động

### Rủi ro người dùng
- **Vấn đề**: Người dùng không hiểu cách sử dụng Credits
- **Giải pháp**: Tutorial, FAQ, support 24/7, demo với credits miễn phí

## Kết luận

Hệ thống Ví ảo KV Credits không chỉ giải quyết bài toán kỹ thuật về hoàn tiền mà còn tạo ra một cơ chế khuyến khích mạnh mẽ để người dùng tiếp tục tham gia vào các hoạt động từ thiện. Điều này sẽ:

1. Tăng retention rate của người dùng
2. Tạo nguồn funding ổn định cho các chiến dịch mới
3. Xây dựng cộng đồng người ủng hộ trung thành
4. Giảm chi phí vận hành và tăng hiệu quả từ thiện

Với việc triển khai từng phase và theo dõi feedback từ cộng đồng, hệ thống này có thể trở thành một differentiator quan trọng của KV Together trong thị trường gây quỹ từ thiện.
